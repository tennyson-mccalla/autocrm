BEGIN; CREATE TABLE IF NOT EXISTS public.tickets (id UUID PRIMARY KEY, title TEXT NOT NULL, description TEXT, status TEXT NOT NULL, priority TEXT NOT NULL, metadata JSONB DEFAULT '{}', created_by UUID NOT NULL REFERENCES auth.users(id), assigned_to UUID REFERENCES auth.users(id), created_at TIMESTAMPTZ DEFAULT NOW(), updated_at TIMESTAMPTZ DEFAULT NOW()); CREATE TABLE IF NOT EXISTS public.queues (id UUID PRIMARY KEY, name TEXT NOT NULL, description TEXT, created_at TIMESTAMPTZ DEFAULT NOW(), updated_at TIMESTAMPTZ DEFAULT NOW()); CREATE TABLE IF NOT EXISTS public.ticket_assignments (ticket_id UUID REFERENCES public.tickets(id), queue_id UUID REFERENCES public.queues(id), created_at TIMESTAMPTZ DEFAULT NOW(), updated_at TIMESTAMPTZ DEFAULT NOW(), PRIMARY KEY (ticket_id, queue_id));
